import {
  i
} from "./chunk-NCP6KRCP.js";
import {
  n
} from "./chunk-6W3EMI7P.js";
import {
  ButtonBase_default,
  Controller,
  Typography_default,
  e,
  require_get,
  styled_default
} from "./chunk-NOLI35SV.js";
import {
  require_react
} from "./chunk-2EXEP7CN.js";
import {
  __toESM
} from "./chunk-WXXH56N5.js";

// node_modules/@jeremyling/react-material-ui-form-builder/dist/es/StandardFileUpload.js
var import_get = __toESM(require_get());
var import_react = __toESM(require_react());
var u = "image";
var p = function() {
  return p = Object.assign || function(e2) {
    for (var i3, r2 = 1, t2 = arguments.length; r2 < t2; r2++)
      for (var o in i3 = arguments[r2])
        Object.prototype.hasOwnProperty.call(i3, o) && (e2[o] = i3[o]);
    return e2;
  }, p.apply(this, arguments);
};
var c = [".pdf", ".doc", ".docx", ".xml", "application/msword", "application/vnd.openxmlformats-officedocument.wordprocessingml.document", ".xls", ".xlsx", ".csv", "image/*", "audio/*", "video/*"];
function f(e2) {
  return e2.flatMap(function(e3) {
    return Array.isArray(e3) ? f(e3) : e3;
  });
}
var m = styled_default("div")(function(e2) {
  var i3, r2, t2 = e2.fieldConfig;
  return { display: "inline-block", position: "relative", width: (null === (i3 = t2.imageSize) || void 0 === i3 ? void 0 : i3[0]) || void 0, height: (null === (r2 = t2.imageSize) || void 0 === r2 ? void 0 : r2[1]) || void 0 };
});
var v = styled_default("div")(function(e2) {
  var i3, r2, t2, o, n2 = e2.fieldConfig;
  return { marginTop: "".concat(Number((null === (i3 = n2.imageSize) || void 0 === i3 ? void 0 : i3[1]) || (null === (r2 = n2.aspectRatio) || void 0 === r2 ? void 0 : r2[1]) || 1) / Number((null === (t2 = n2.imageSize) || void 0 === t2 ? void 0 : t2[0]) || (null === (o = n2.aspectRatio) || void 0 === o ? void 0 : o[0]) || 1) * 100, "%") };
});
var x = styled_default("div")(function() {
  return { position: "absolute", top: 0, bottom: 0, right: 0, left: 0 };
});
var g = styled_default("img")(function() {
  return { width: "100%", height: "100%", objectFit: "contain" };
});
var h = styled_default(Typography_default)(function(e2) {
  return { textAlign: "start", borderRadius: "4px", padding: "7px 10px", color: "rgba(0, 0, 0, 0.87)", overflow: "hidden", whiteSpace: "nowrap", margin: e2.theme.spacing(1, 0) };
});
var b = styled_default(ButtonBase_default)(function() {
  return { width: "100%", display: "block" };
});
function j(n2) {
  var l = n2.field, a = n2.methods, j2 = a.control;
  a.getValues;
  var y = a.setValue, T = a.trigger, U = a.formState.errors, w = n2.hideTitle, z = (0, import_react.useState)([]), S = z[0], C = z[1], A = (0, import_react.useMemo)(function() {
    return l.maxSizeMb || 2;
  }, [l.maxSizeMb]), O = (0, import_react.useMemo)(function() {
    return (e2 = l.acceptTypes) && "string" == typeof e2.valueOf() ? l.acceptTypes : Array.isArray(l.acceptTypes) ? f(l.acceptTypes).join(",") : c.join(",");
    var e2;
  }, [l.acceptTypes]), R = function(e2) {
    if (!e2 || e2.length < 1)
      C(["Nothing selected"]);
    else {
      for (var i3 = { files: [], imageUrls: [] }, r2 = [], t2 = 0, o = Array.from(e2); t2 < o.length; t2++) {
        var n3 = o[t2];
        if (n3.size > 1024 * A * 1024)
          r2.push((n3.name || "File") + " should be less than " + A + " MB");
        else if (i3.files.push(n3), l.fileType === u) {
          var a2 = URL.createObjectURL(n3);
          i3.imageUrls.push(a2);
        }
      }
      l.multiple || (i3 = { files: [i3.files[0]], imageUrls: [i3.imageUrls[0]] }), y(l.attribute, i3), C(r2);
    }
  }, F = function(e2) {
    return p({ id: e2.id || e2.attribute, type: "file", hidden: true, multiple: false, accept: O, onChange: function(e3) {
      return R(e3.target.files);
    } }, e2.props);
  };
  return e.exports.jsx(Controller, { name: l.attribute, control: j2, render: function(r2) {
    var t2, o, n3, a2, c2, f2 = r2.field;
    return e.exports.jsxs(e.exports.Fragment, { children: [!w && l.title && e.exports.jsx(n, { field: l }), e.exports.jsx("input", p({}, F(l))), e.exports.jsx("label", p({ htmlFor: l.id || l.attribute, onBlur: function() {
      return T(l.attribute);
    } }, { children: (null === (o = null === (t2 = f2.value) || void 0 === t2 ? void 0 : t2.files) || void 0 === o ? void 0 : o.length) > 0 ? f2.value.files.map(function(r3, t3) {
      var o2, n4;
      return e.exports.jsxs(b, p({ component: "div" }, { children: [l.fileType === u && (null === (o2 = f2.value.imageUrls) || void 0 === o2 ? void 0 : o2.length) > 0 && e.exports.jsxs(m, p({ fieldConfig: l }, { children: [e.exports.jsx(v, { fieldConfig: l }), e.exports.jsx(x, { children: e.exports.jsx(g, { src: null === (n4 = f2.value.imageUrls) || void 0 === n4 ? void 0 : n4[t3], alt: r3.name, loading: "lazy" }) })] })), e.exports.jsx(h, p({ sx: { border: function(e2) {
        return "1px solid ".concat((0, import_get.default)(U, l.attribute) ? e2.palette.error.main : "#b9b9b9");
      } } }, { children: r3.name || r3 }))] }), t3);
    }) : e.exports.jsxs(b, p({ component: "div" }, { children: [l.fileType === u && (null === (n3 = l.imageUrls) || void 0 === n3 ? void 0 : n3[0]) && e.exports.jsxs(m, p({ fieldConfig: l }, { children: [e.exports.jsx(v, { fieldConfig: l }), e.exports.jsx(x, { children: e.exports.jsx(g, { src: l.imageUrls[0], alt: l.label, loading: "lazy" }) })] })), e.exports.jsx(h, p({ sx: { color: "#777777", border: function(e2) {
      return "1px solid ".concat((0, import_get.default)(U, l.attribute) ? e2.palette.error.main : "#b9b9b9");
    } } }, { children: (null === (a2 = l.imageUrls) || void 0 === a2 ? void 0 : a2[0]) || l.label }))] })) })), !!(0, import_get.default)(U, l.attribute) && e.exports.jsx(i, { error: null === (c2 = (0, import_get.default)(U, l.attribute)) || void 0 === c2 ? void 0 : c2.message }), (null == S ? void 0 : S.length) > 0 && e.exports.jsx(i, { error: S[0] })] });
  } });
}

export {
  j
};
//# sourceMappingURL=chunk-2KPIZOKW.js.map
